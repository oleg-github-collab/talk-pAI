<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Talk pAI - Award-Winning Ultra-Modern Messenger</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=SF+Pro+Display:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/webrtc-calls.css">
    <style>
        /* ===== AWARD-WINNING ULTRA-MODERN MESSENGER DESIGN SYSTEM ===== */

        :root {
            /* Core Design Tokens */
            --font-primary: 'SF Pro Display', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-mono: 'SF Mono', Monaco, 'Cascadia Code', monospace;

            /* Enhanced Spacing System - Perfect Mathematical Progression */
            --spacing-2xs: 2px;
            --spacing-xs: 4px;
            --spacing-sm: 6px;
            --spacing-md: 8px;
            --spacing-lg: 12px;
            --spacing-xl: 16px;
            --spacing-2xl: 24px;
            --spacing-3xl: 32px;
            --spacing-4xl: 48px;
            --spacing-5xl: 64px;
            --spacing-6xl: 96px;

            /* Typography Scale - Perfect Modular Scale */
            --scale-ratio: 1.125; /* Major Second for harmonious proportions */
            --text-2xs: 0.694rem;  /* 11px */
            --text-xs: 0.75rem;    /* 12px */
            --text-sm: 0.875rem;   /* 14px */
            --text-base: 1rem;     /* 16px */
            --text-lg: 1.125rem;   /* 18px */
            --text-xl: 1.25rem;    /* 20px */
            --text-2xl: 1.5rem;    /* 24px */
            --text-3xl: 1.875rem;  /* 30px */
            --text-4xl: 2.25rem;   /* 36px */

            /* Perfect Grid System */
            --grid-columns: 12;
            --grid-gap: var(--spacing-lg);
            --container-max-width: 1440px;
            --container-padding: var(--spacing-xl);

            /* Border Radius System */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 20px;
            --radius-2xl: 24px;
            --radius-3xl: 28px;
            --radius-full: 50%;

            /* Animation System */
            --transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            --spring: cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);

            /* Layout Dimensions */
            --sidebar-width: 280px;
            --sidebar-collapsed: 72px;
            --chat-list-width: 340px;
            --header-height: 72px;
            --input-height: 84px;

            /* Glassmorphism */
            --glass-opacity: 0.85;
            --glass-blur: 20px;
            --glass-border: rgba(255, 255, 255, 0.1);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);

            /* Light Theme Palette */
            --light-bg-primary: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            --light-bg-secondary: linear-gradient(135deg, #ffffff 0%, #f1f5f9 100%);
            --light-glass: rgba(255, 255, 255, var(--glass-opacity));
            --light-glass-subtle: rgba(255, 255, 255, 0.4);
            --light-text-primary: #0f172a;
            --light-text-secondary: #475569;
            --light-text-tertiary: #94a3b8;
            --light-accent-sky: #0ea5e9;
            --light-accent-mint: #10b981;
            --light-accent-lilac: #8b5cf6;
            --light-accent-peach: #f97316;
            --light-shadow: rgba(15, 23, 42, 0.08);
            --light-neon: rgba(14, 165, 233, 0.4);

            /* Dark Theme Palette */
            --dark-bg-primary: linear-gradient(135deg, #0c0c0c 0%, #1a1a1a 100%);
            --dark-bg-secondary: linear-gradient(135deg, #000000 0%, #0f0f0f 100%);
            --dark-glass: rgba(255, 255, 255, 0.08);
            --dark-glass-subtle: rgba(255, 255, 255, 0.04);
            --dark-text-primary: #f8fafc;
            --dark-text-secondary: #e2e8f0;
            --dark-text-tertiary: #94a3b8;
            --dark-accent-cyan: #22d3ee;
            --dark-accent-purple: #a855f7;
            --dark-accent-magenta: #e879f9;
            --dark-accent-green: #10b981;
            --dark-shadow: rgba(0, 0, 0, 0.3);
            --dark-neon: rgba(34, 211, 238, 0.6);

            /* Active Theme Variables */
            --bg-primary: var(--light-bg-primary);
            --bg-secondary: var(--light-bg-secondary);
            --glass-bg: var(--light-glass);
            --glass-subtle: var(--light-glass-subtle);
            --text-primary: var(--light-text-primary);
            --text-secondary: var(--light-text-secondary);
            --text-tertiary: var(--light-text-tertiary);
            --accent-primary: var(--light-accent-sky);
            --accent-secondary: var(--light-accent-mint);
            --accent-tertiary: var(--light-accent-lilac);
            --accent-quaternary: var(--light-accent-peach);
            --shadow-color: var(--light-shadow);
            --neon-glow: var(--light-neon);
        }

        [data-theme="dark"] {
            --bg-primary: var(--dark-bg-primary);
            --bg-secondary: var(--dark-bg-secondary);
            --glass-bg: var(--dark-glass);
            --glass-subtle: var(--dark-glass-subtle);
            --text-primary: var(--dark-text-primary);
            --text-secondary: var(--dark-text-secondary);
            --text-tertiary: var(--dark-text-tertiary);
            --accent-primary: var(--dark-accent-cyan);
            --accent-secondary: var(--dark-accent-purple);
            --accent-tertiary: var(--dark-accent-magenta);
            --accent-quaternary: var(--dark-accent-green);
            --shadow-color: var(--dark-shadow);
            --neon-glow: var(--dark-neon);
        }

        /* ===== RESET & BASE STYLES ===== */

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-primary);
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow: hidden;
            position: relative;
            line-height: 1.6;
            font-weight: 400;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            z-index: -2;
        }

        /* ===== FLOATING BACKGROUND ELEMENTS ===== */

        .bg-elements {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }

        .floating-orb {
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            opacity: 0.03;
            animation: float-gentle 20s infinite ease-in-out;
            filter: blur(2px);
        }

        .floating-orb:nth-child(1) {
            width: 300px;
            height: 300px;
            top: -150px;
            right: -150px;
            animation-delay: 0s;
        }

        .floating-orb:nth-child(2) {
            width: 200px;
            height: 200px;
            bottom: -100px;
            left: -100px;
            animation-delay: 7s;
        }

        .floating-orb:nth-child(3) {
            width: 150px;
            height: 150px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation-delay: 14s;
        }

        @keyframes float-gentle {
            0%, 100% {
                transform: translate(0, 0) rotate(0deg) scale(1);
            }
            33% {
                transform: translate(30px, -30px) rotate(120deg) scale(1.1);
            }
            66% {
                transform: translate(-20px, 20px) rotate(240deg) scale(0.9);
            }
        }

        /* ===== MAIN LAYOUT ===== */

        .app-container {
            display: flex;
            height: 100vh;
            width: 100vw;
            position: relative;
        }

        /* ===== PROFESSIONAL SIDEBAR ===== */

        .sidebar {
            width: var(--sidebar-width);
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            border-right: 1px solid var(--glass-border);
            display: flex;
            flex-direction: column;
            transition: width var(--transition-normal) var(--spring);
            position: relative;
            z-index: 100;
            box-shadow: var(--glass-shadow);
        }

        .sidebar.collapsed {
            width: var(--sidebar-collapsed);
        }

        /* Sidebar Header */
        .sidebar-header {
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--glass-border);
            position: relative;
        }

        .sidebar.collapsed .sidebar-header {
            padding: var(--spacing-md);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            cursor: pointer;
            padding: var(--spacing-md);
            border-radius: var(--radius-lg);
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .user-profile::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--glass-subtle);
            border-radius: var(--radius-lg);
            opacity: 0;
            transition: all var(--transition-normal);
        }

        .user-profile:hover::before {
            opacity: 1;
        }

        .user-profile:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 32px var(--neon-glow);
        }

        .user-avatar {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 18px;
            position: relative;
            flex-shrink: 0;
        }

        .user-avatar::after {
            content: '';
            position: absolute;
            bottom: 2px;
            right: 2px;
            width: 12px;
            height: 12px;
            background: var(--accent-secondary);
            border: 2px solid var(--glass-bg);
            border-radius: var(--radius-full);
            animation: pulse 2s infinite;
        }

        .user-info {
            flex: 1;
            min-width: 0;
            opacity: 1;
            transition: all var(--transition-normal);
            position: relative;
            z-index: 1;
        }

        .sidebar.collapsed .user-info {
            opacity: 0;
            transform: translateX(-20px);
        }

        .user-name {
            font-weight: 600;
            font-size: 16px;
            color: var(--text-primary);
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .user-status {
            font-size: 14px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .status-indicator {
            width: 6px;
            height: 6px;
            border-radius: var(--radius-full);
            background: var(--accent-secondary);
            animation: pulse 2s infinite;
        }

        /* Sidebar Navigation */
        .sidebar-nav {
            flex: 1;
            padding: var(--spacing-lg) var(--spacing-md);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        .sidebar.collapsed .sidebar-nav {
            padding: var(--spacing-lg) var(--spacing-sm);
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
            text-decoration: none;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--glass-subtle);
            border-radius: var(--radius-lg);
            opacity: 0;
            transition: all var(--transition-normal);
        }

        .nav-item:hover::before {
            opacity: 1;
        }

        .nav-item:hover {
            transform: translateX(4px);
            color: var(--text-primary);
            box-shadow: 0 4px 20px var(--neon-glow);
        }

        .nav-item.active {
            background: var(--accent-primary);
            color: white;
            box-shadow: 0 8px 32px var(--neon-glow);
        }

        .nav-item.active::before {
            display: none;
        }

        .nav-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 1;
        }

        .nav-icon svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
            transition: all var(--transition-normal);
        }

        .nav-item:hover .nav-icon svg {
            transform: scale(1.1);
        }

        .nav-text {
            opacity: 1;
            transition: all var(--transition-normal);
            position: relative;
            z-index: 1;
            white-space: nowrap;
        }

        .sidebar.collapsed .nav-text {
            opacity: 0;
            transform: translateX(-20px);
        }

        .nav-badge {
            margin-left: auto;
            background: var(--accent-primary);
            color: white;
            font-size: 12px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: var(--radius-full);
            min-width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 2s infinite;
            opacity: 1;
            transition: all var(--transition-normal);
            position: relative;
            z-index: 1;
        }

        .sidebar.collapsed .nav-badge {
            opacity: 0;
            transform: scale(0.8);
        }

        /* Sidebar Footer */
        .sidebar-footer {
            padding: var(--spacing-lg);
            border-top: 1px solid var(--glass-border);
        }

        .sidebar.collapsed .sidebar-footer {
            padding: var(--spacing-md);
        }

        .sidebar-toggle {
            width: 40px;
            height: 40px;
            background: var(--glass-subtle);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-normal);
            color: var(--text-secondary);
        }

        .sidebar-toggle:hover {
            background: var(--accent-primary);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 8px 32px var(--neon-glow);
        }

        .sidebar-toggle svg {
            width: 20px;
            height: 20px;
            transition: all var(--transition-normal);
        }

        .sidebar.collapsed .sidebar-toggle svg {
            transform: rotate(180deg);
        }

        /* ===== CHAT LIST PANEL ===== */

        .chat-list-panel {
            width: var(--chat-list-width);
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            border-right: 1px solid var(--glass-border);
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 90;
            box-shadow: var(--glass-shadow);
        }

        /* Chat List Header */
        .chat-list-header {
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .chat-list-title {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-list-title h2 {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0;
        }

        .new-chat-btn {
            width: 40px;
            height: 40px;
            background: var(--accent-primary);
            border: none;
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-normal);
            color: white;
            box-shadow: 0 4px 20px var(--neon-glow);
        }

        .new-chat-btn:hover {
            transform: scale(1.1) rotate(90deg);
            box-shadow: 0 8px 32px var(--neon-glow);
        }

        .new-chat-btn svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        /* Global Search */
        .global-search {
            position: relative;
        }

        .search-input {
            width: 100%;
            background: var(--glass-subtle);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-xl);
            padding: var(--spacing-md) var(--spacing-md) var(--spacing-md) 48px;
            color: var(--text-primary);
            font-size: 16px;
            outline: none;
            transition: all var(--transition-normal);
            backdrop-filter: blur(var(--glass-blur));
        }

        .search-input:focus {
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px var(--neon-glow);
            transform: scale(1.02);
        }

        .search-input::placeholder {
            color: var(--text-tertiary);
        }

        .search-icon {
            position: absolute;
            left: var(--spacing-md);
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-tertiary);
            transition: all var(--transition-normal);
            pointer-events: none;
        }

        .search-input:focus + .search-icon {
            color: var(--accent-primary);
        }

        .search-icon svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        /* Chat List */
        .chat-list {
            flex: 1;
            overflow-y: auto;
            padding: var(--spacing-md);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        .chat-list::-webkit-scrollbar {
            width: 6px;
        }

        .chat-list::-webkit-scrollbar-track {
            background: transparent;
        }

        .chat-list::-webkit-scrollbar-thumb {
            background: var(--glass-subtle);
            border-radius: 3px;
            backdrop-filter: blur(10px);
        }

        .chat-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
            text-decoration: none;
            color: inherit;
        }

        .chat-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--glass-subtle);
            border-radius: var(--radius-lg);
            opacity: 0;
            transition: all var(--transition-normal);
        }

        .chat-item:hover::before {
            opacity: 1;
        }

        .chat-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 32px var(--neon-glow);
        }

        .chat-item.active {
            background: var(--accent-primary);
            color: white;
            box-shadow: 0 8px 32px var(--neon-glow);
        }

        .chat-item.active::before {
            display: none;
        }

        .chat-avatar {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--accent-secondary), var(--accent-tertiary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 18px;
            flex-shrink: 0;
            position: relative;
            z-index: 1;
        }

        .chat-info {
            flex: 1;
            min-width: 0;
            position: relative;
            z-index: 1;
        }

        .chat-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .chat-preview {
            font-size: 14px;
            color: var(--text-secondary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .chat-item.active .chat-preview {
            color: rgba(255, 255, 255, 0.8);
        }

        .chat-meta {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: var(--spacing-xs);
            flex-shrink: 0;
            position: relative;
            z-index: 1;
        }

        .chat-time {
            font-size: 12px;
            color: var(--text-tertiary);
            font-weight: 500;
        }

        .chat-item.active .chat-time {
            color: rgba(255, 255, 255, 0.7);
        }

        .chat-unread {
            background: var(--accent-primary);
            color: white;
            font-size: 12px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: var(--radius-full);
            min-width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: pulse 2s infinite;
        }

        .chat-item.active .chat-unread {
            background: rgba(255, 255, 255, 0.2);
        }

        /* ===== MAIN CHAT AREA ===== */

        .main-chat {
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            background: var(--bg-secondary);
        }

        /* Chat Header */
        .chat-header {
            height: var(--header-height);
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 var(--spacing-xl);
            position: relative;
            z-index: 80;
            box-shadow: var(--glass-shadow);
        }

        .chat-header-info {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .chat-header-avatar {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 16px;
            position: relative;
        }

        .chat-header-avatar::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 12px;
            height: 12px;
            background: var(--accent-secondary);
            border: 2px solid var(--glass-bg);
            border-radius: var(--radius-full);
            animation: pulse 2s infinite;
        }

        .chat-header-details {
            flex: 1;
            min-width: 0;
        }

        .chat-header-name {
            font-weight: 600;
            font-size: 18px;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .chat-header-status {
            font-size: 14px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            color: var(--accent-primary);
        }

        .typing-dot {
            width: 4px;
            height: 4px;
            border-radius: var(--radius-full);
            background: var(--accent-primary);
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 80%, 100% {
                transform: scale(0);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .chat-header-actions {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .header-action-btn {
            width: 44px;
            height: 44px;
            background: var(--glass-subtle);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-normal);
            color: var(--text-secondary);
        }

        .header-action-btn:hover {
            background: var(--accent-primary);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 8px 32px var(--neon-glow);
        }

        .header-action-btn svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        /* ===== VOICE & VIDEO CALL INTERFACE ===== */

        .call-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg,
                rgba(13, 16, 23, 0.95) 0%,
                rgba(17, 24, 39, 0.95) 50%,
                rgba(13, 16, 23, 0.95) 100%);
            backdrop-filter: blur(40px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.5s var(--spring);
        }

        .call-overlay.active {
            display: flex;
        }

        .call-interface {
            width: 100%;
            max-width: 1200px;
            height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .call-header {
            padding: var(--spacing-xl);
            text-align: center;
            position: relative;
            z-index: 10;
        }

        .call-user-info {
            margin-bottom: var(--spacing-lg);
        }

        .call-avatar {
            width: 120px;
            height: 120px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--spacing-md);
            font-size: 48px;
            font-weight: 600;
            color: white;
            position: relative;
            animation: callPulse 2s infinite;
            box-shadow: 0 20px 60px rgba(var(--accent-primary-rgb), 0.3);
        }

        .call-avatar::after {
            content: '';
            position: absolute;
            inset: -10px;
            border: 3px solid var(--accent-primary);
            border-radius: var(--radius-full);
            animation: ripple 2s infinite;
            opacity: 0.6;
        }

        @keyframes callPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes ripple {
            0% {
                transform: scale(1);
                opacity: 0.6;
            }
            100% {
                transform: scale(1.3);
                opacity: 0;
            }
        }

        .call-user-name {
            font-size: 28px;
            font-weight: 600;
            color: white;
            margin-bottom: var(--spacing-xs);
        }

        .call-status {
            font-size: 16px;
            color: var(--accent-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-xs);
        }

        .call-timer {
            font-family: 'SF Mono', monospace;
            font-size: 18px;
            color: var(--text-secondary);
            text-align: center;
            margin-top: var(--spacing-md);
        }

        .video-container {
            flex: 1;
            position: relative;
            margin: 0 var(--spacing-xl) var(--spacing-xl);
            border-radius: var(--radius-3xl);
            overflow: hidden;
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
        }

        .main-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            background: linear-gradient(135deg,
                rgba(var(--accent-primary-rgb), 0.1),
                rgba(var(--accent-secondary-rgb), 0.1));
        }

        .local-video {
            position: absolute;
            top: var(--spacing-lg);
            right: var(--spacing-lg);
            width: 200px;
            height: 150px;
            border-radius: var(--radius-xl);
            overflow: hidden;
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            border: 2px solid var(--glass-border);
            transition: all var(--transition-normal);
            cursor: pointer;
        }

        .local-video:hover {
            transform: scale(1.05);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .local-video video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .call-controls {
            padding: var(--spacing-xl);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-lg);
            position: relative;
            z-index: 10;
        }

        .call-control-btn {
            width: 64px;
            height: 64px;
            border-radius: var(--radius-full);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .call-control-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: var(--radius-full);
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            transition: all var(--transition-normal);
        }

        .call-control-btn svg {
            width: 24px;
            height: 24px;
            color: white;
            position: relative;
            z-index: 1;
        }

        .call-control-btn:hover {
            transform: scale(1.1);
        }

        .call-control-btn:active {
            transform: scale(0.95);
        }

        /* Specific Control Button Styles */
        .btn-mute::before {
            background: linear-gradient(135deg, #6B7280, #9CA3AF);
        }

        .btn-mute.active::before {
            background: linear-gradient(135deg, #EF4444, #DC2626);
        }

        .btn-camera::before {
            background: linear-gradient(135deg, #6B7280, #9CA3AF);
        }

        .btn-camera.active::before {
            background: linear-gradient(135deg, #EF4444, #DC2626);
        }

        .btn-end-call::before {
            background: linear-gradient(135deg, #EF4444, #DC2626);
            box-shadow: 0 8px 32px rgba(239, 68, 68, 0.4);
        }

        .btn-end-call:hover::before {
            background: linear-gradient(135deg, #DC2626, #B91C1C);
            transform: scale(1.05);
        }

        .btn-speaker::before {
            background: linear-gradient(135deg, #10B981, #059669);
        }

        .btn-more::before {
            background: linear-gradient(135deg, #6366F1, #4F46E5);
        }

        /* Incoming Call Style */
        .call-overlay.incoming .call-controls {
            justify-content: space-around;
            max-width: 300px;
            margin: 0 auto;
        }

        .btn-answer::before {
            background: linear-gradient(135deg, #10B981, #059669);
            box-shadow: 0 8px 32px rgba(16, 185, 129, 0.4);
        }

        .btn-decline::before {
            background: linear-gradient(135deg, #EF4444, #DC2626);
            box-shadow: 0 8px 32px rgba(239, 68, 68, 0.4);
        }

        /* Call Notification */
        .call-notification {
            position: fixed;
            top: var(--spacing-xl);
            right: var(--spacing-xl);
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-lg);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            z-index: 999;
            min-width: 320px;
            animation: slideInRight 0.5s var(--spring);
            display: none;
        }

        .call-notification.active {
            display: block;
        }

        .call-notification-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        .call-notification-avatar {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .call-notification-info {
            flex: 1;
        }

        .call-notification-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .call-notification-type {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .call-notification-actions {
            display: flex;
            gap: var(--spacing-md);
            justify-content: flex-end;
        }

        .call-notification-btn {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-normal);
        }

        .call-notification-btn svg {
            width: 18px;
            height: 18px;
            color: white;
        }

        .btn-notification-answer {
            background: linear-gradient(135deg, #10B981, #059669);
        }

        .btn-notification-decline {
            background: linear-gradient(135deg, #EF4444, #DC2626);
        }

        .call-notification-btn:hover {
            transform: scale(1.1);
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Screen Share Indicator */
        .screen-share-indicator {
            position: absolute;
            top: var(--spacing-lg);
            left: var(--spacing-lg);
            background: linear-gradient(135deg, #F59E0B, #D97706);
            color: white;
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--radius-full);
            font-size: 14px;
            font-weight: 600;
            display: none;
            align-items: center;
            gap: var(--spacing-xs);
            backdrop-filter: blur(var(--glass-blur));
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .screen-share-indicator.active {
            display: flex;
        }

        .screen-share-indicator::before {
            content: '';
            width: 8px;
            height: 8px;
            background: white;
            border-radius: var(--radius-full);
            animation: pulse 2s infinite;
        }

        /* ===== DRAG & DROP WITH MAGNETIC EFFECTS ===== */

        .drag-drop-zone {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg,
                rgba(var(--accent-primary-rgb), 0.1),
                rgba(var(--accent-secondary-rgb), 0.1));
            backdrop-filter: blur(20px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 999;
            animation: fadeIn 0.3s var(--spring);
        }

        .drag-drop-zone.active {
            display: flex;
        }

        .drop-area {
            width: 400px;
            height: 300px;
            border: 3px dashed var(--accent-primary);
            border-radius: var(--radius-3xl);
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-lg);
            transition: all var(--transition-smooth);
            position: relative;
            overflow: hidden;
        }

        .drop-area.drag-over {
            border-color: var(--accent-secondary);
            transform: scale(1.05);
            box-shadow: 0 20px 60px rgba(var(--accent-primary-rgb), 0.3);
        }

        .drop-area::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg,
                rgba(var(--accent-primary-rgb), 0.1),
                rgba(var(--accent-secondary-rgb), 0.1));
            opacity: 0;
            transition: all var(--transition-smooth);
            border-radius: var(--radius-3xl);
        }

        .drop-area.drag-over::before {
            opacity: 1;
        }

        .drop-icon {
            width: 80px;
            height: 80px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
            position: relative;
            z-index: 1;
            animation: float 3s ease-in-out infinite;
        }

        .drop-text {
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .drop-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-xs);
        }

        .drop-subtitle {
            font-size: 16px;
            color: var(--text-secondary);
        }

        /* Magnetic Effect for Draggable Elements */
        .draggable {
            cursor: grab;
            transition: all var(--transition-normal);
            position: relative;
        }

        .draggable:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px var(--shadow-color);
        }

        .draggable.dragging {
            cursor: grabbing;
            transform: scale(1.05) rotate(5deg);
            opacity: 0.8;
            z-index: 1000;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .magnetic-field {
            position: relative;
        }

        .magnetic-field::before {
            content: '';
            position: absolute;
            inset: -20px;
            border: 2px solid transparent;
            border-radius: var(--radius-xl);
            opacity: 0;
            transition: all var(--transition-smooth);
            background: linear-gradient(135deg,
                rgba(var(--accent-primary-rgb), 0.2),
                rgba(var(--accent-secondary-rgb), 0.2));
        }

        .magnetic-field.attracting::before {
            opacity: 1;
            inset: -10px;
            border-color: var(--accent-primary);
        }

        /* File Upload Preview */
        .file-preview {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-xl);
            min-width: 320px;
            max-width: 500px;
            z-index: 1001;
            display: none;
            animation: slideInDown 0.5s var(--spring);
        }

        .file-preview.active {
            display: block;
        }

        .file-preview-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--spacing-lg);
        }

        .file-preview-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .file-preview-close {
            width: 32px;
            height: 32px;
            border: none;
            background: var(--glass-subtle);
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .file-preview-close:hover {
            background: var(--accent-primary);
            color: white;
            transform: scale(1.1);
        }

        .file-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .file-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            background: var(--glass-subtle);
            border-radius: var(--radius-lg);
            transition: all var(--transition-normal);
        }

        .file-item:hover {
            background: var(--glass-bg);
            transform: translateY(-2px);
        }

        .file-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-lg);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .file-info {
            flex: 1;
            min-width: 0;
        }

        .file-name {
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .file-size {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .file-remove {
            width: 24px;
            height: 24px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: var(--radius-full);
            transition: all var(--transition-normal);
        }

        .file-remove:hover {
            background: var(--accent-error);
            color: white;
        }

        .file-actions {
            display: flex;
            gap: var(--spacing-md);
            justify-content: flex-end;
        }

        .file-action-btn {
            padding: var(--spacing-sm) var(--spacing-lg);
            border: none;
            border-radius: var(--radius-lg);
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .btn-cancel {
            background: var(--glass-subtle);
            color: var(--text-secondary);
        }

        .btn-cancel:hover {
            background: var(--glass-bg);
            color: var(--text-primary);
        }

        .btn-send {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
        }

        .btn-send:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(var(--accent-primary-rgb), 0.4);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes slideInDown {
            from {
                transform: translate(-50%, -60%);
                opacity: 0;
            }
            to {
                transform: translate(-50%, -50%);
                opacity: 1;
            }
        }

        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        /* ===== FLOATING MODALS WITH CASCADE STACKING ===== */

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(8px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.3s var(--spring);
        }

        .modal-overlay.active {
            display: flex;
        }

        .floating-modal {
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-2xl);
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4);
            min-width: 400px;
            max-width: 90vw;
            max-height: 90vh;
            overflow: hidden;
            position: relative;
            transform: scale(0.9) translateY(20px);
            transition: all var(--transition-smooth);
            animation: modalEnter 0.5s var(--spring) forwards;
        }

        .floating-modal.stacked {
            transform: scale(0.95) translateY(-10px);
            opacity: 0.8;
            box-shadow: 0 15px 60px rgba(0, 0, 0, 0.3);
        }

        .floating-modal.stacked-deep {
            transform: scale(0.9) translateY(-20px);
            opacity: 0.6;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            padding: var(--spacing-lg) var(--spacing-xl);
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: move;
            user-select: none;
            background: linear-gradient(135deg,
                rgba(var(--accent-primary-rgb), 0.1),
                rgba(var(--accent-secondary-rgb), 0.05));
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .modal-icon {
            width: 24px;
            height: 24px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
        }

        .modal-controls {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .modal-control-btn {
            width: 28px;
            height: 28px;
            border: none;
            border-radius: var(--radius-full);
            background: var(--glass-subtle);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-normal);
        }

        .modal-control-btn:hover {
            background: var(--accent-primary);
            color: white;
            transform: scale(1.1);
        }

        .modal-control-btn.minimize:hover {
            background: var(--accent-warning);
        }

        .modal-control-btn.maximize:hover {
            background: var(--accent-success);
        }

        .modal-control-btn.close:hover {
            background: var(--accent-error);
        }

        .modal-body {
            padding: var(--spacing-xl);
            max-height: 60vh;
            overflow-y: auto;
        }

        .modal-body::-webkit-scrollbar {
            width: 8px;
        }

        .modal-body::-webkit-scrollbar-track {
            background: transparent;
        }

        .modal-body::-webkit-scrollbar-thumb {
            background: var(--glass-subtle);
            border-radius: 4px;
        }

        .modal-body::-webkit-scrollbar-thumb:hover {
            background: var(--glass-bg);
        }

        .modal-footer {
            padding: var(--spacing-lg) var(--spacing-xl);
            border-top: 1px solid var(--glass-border);
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-md);
            background: var(--glass-subtle);
        }

        .modal-btn {
            padding: var(--spacing-sm) var(--spacing-lg);
            border: none;
            border-radius: var(--radius-lg);
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .modal-btn-secondary {
            background: var(--glass-bg);
            color: var(--text-secondary);
            border: 1px solid var(--glass-border);
        }

        .modal-btn-secondary:hover {
            background: var(--glass-subtle);
            color: var(--text-primary);
        }

        .modal-btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
        }

        .modal-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(var(--accent-primary-rgb), 0.4);
        }

        /* Enhanced Cascade Stacking System */
        .modal-stack-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 2000;
        }

        .floating-modal.modal-stacked {
            transition: all var(--transition-normal) var(--spring);
            cursor: pointer;
        }

        .floating-modal.modal-stacked:hover {
            filter: blur(0px) brightness(1) !important;
            opacity: 1 !important;
            transform: translate(calc(-50% + var(--offset-x, 0px)), calc(-50% + var(--offset-y, 0px))) scale(1.02) !important;
        }

        .floating-modal.modal-minimized {
            transition: all var(--transition-normal) var(--spring);
            cursor: pointer;
            border: 2px solid var(--accent-primary);
            overflow: hidden;
        }

        .floating-modal.modal-minimized .modal-body,
        .floating-modal.modal-minimized .modal-footer {
            display: none;
        }

        .floating-modal.modal-minimized .modal-header {
            padding: var(--spacing-sm);
            border-bottom: none;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .floating-modal.modal-minimized .modal-title {
            font-size: 12px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .floating-modal.modal-minimized:hover {
            transform: translate(var(--taskbar-x), var(--taskbar-y)) scale(0.35) !important;
            box-shadow: 0 8px 32px var(--neon-glow);
        }

        .floating-modal.modal-maximized {
            border-radius: var(--radius-lg) !important;
            margin: 20px;
        }

        .floating-modal.modal-maximized .modal-body {
            max-height: calc(100vh - 200px);
        }

        /* Modal Animation Keyframes */
        @keyframes modalStackEnter {
            0% {
                transform: translate(-50%, -50%) scale(0.8) rotateY(20deg);
                opacity: 0;
                filter: blur(10px);
            }
            100% {
                transform: translate(-50%, -50%) scale(1) rotateY(0deg);
                opacity: 1;
                filter: blur(0px);
            }
        }

        @keyframes modalStackExit {
            0% {
                transform: translate(-50%, -50%) scale(1) rotateY(0deg);
                opacity: 1;
                filter: blur(0px);
            }
            100% {
                transform: translate(-50%, -50%) scale(0.8) rotateY(-20deg);
                opacity: 0;
                filter: blur(10px);
            }
        }

        @keyframes modalMinimize {
            0% {
                transform: translate(-50%, -50%) scale(1);
                border-radius: var(--radius-lg);
            }
            100% {
                transform: translate(var(--taskbar-x), var(--taskbar-y)) scale(0.3);
                border-radius: var(--radius-xl);
            }
        }

        @keyframes modalMaximize {
            0% {
                transform: translate(-50%, -50%) scale(1);
                width: auto;
                height: auto;
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                width: calc(100vw - 40px);
                height: calc(100vh - 40px);
            }
        }

        /* Modal Focus Ring */
        .floating-modal:focus-within {
            outline: 2px solid var(--accent-primary);
            outline-offset: 4px;
        }

        /* Enhanced Controls */
        .modal-controls {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            opacity: 0;
            transition: all var(--transition-fast);
        }

        .modal-header:hover .modal-controls {
            opacity: 1;
        }

        .modal-control-btn {
            width: 20px;
            height: 20px;
            border: none;
            border-radius: var(--radius-full);
            background: var(--glass-subtle);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .modal-control-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: currentColor;
            opacity: 0;
            transition: all var(--transition-fast);
            border-radius: inherit;
        }

        .modal-control-btn:hover::before {
            opacity: 0.1;
        }

        .modal-control-btn:hover {
            transform: scale(1.1);
        }

        .modal-control-btn.minimize:hover {
            background: #fbbf24;
            color: white;
        }

        .modal-control-btn.maximize:hover {
            background: #10b981;
            color: white;
        }

        .modal-control-btn.close:hover {
            background: #ef4444;
            color: white;
        }

        /* Stack Depth Indicators */
        .floating-modal::after {
            content: '';
            position: absolute;
            top: -5px;
            right: -5px;
            width: 20px;
            height: 20px;
            background: var(--accent-primary);
            border-radius: var(--radius-full);
            font-size: 11px;
            font-weight: 600;
            color: white;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .floating-modal.modal-stacked::after {
            display: flex;
            content: attr(data-stack-index);
        }

        /* Draggable Modal */
        .floating-modal.dragging {
            cursor: grabbing;
            transform: scale(1.02);
            box-shadow: 0 30px 100px rgba(0, 0, 0, 0.5);
            z-index: 9999 !important;
        }

        .floating-modal.minimized {
            transform: scale(0) translateY(100px);
            opacity: 0;
            pointer-events: none;
        }

        .floating-modal.maximized {
            width: 95vw !important;
            height: 95vh !important;
            top: 2.5vh !important;
            left: 2.5vw !important;
            transform: none !important;
        }

        /* Specific Modal Types */
        .profile-modal .modal-body {
            text-align: center;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
            font-weight: 600;
            margin: 0 auto var(--spacing-lg);
        }

        .profile-name {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-xs);
        }

        .profile-status {
            color: var(--text-secondary);
            margin-bottom: var(--spacing-lg);
        }

        .profile-info {
            text-align: left;
            margin-top: var(--spacing-lg);
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-md) 0;
            border-bottom: 1px solid var(--glass-border);
        }

        .info-label {
            color: var(--text-secondary);
            font-weight: 500;
        }

        .info-value {
            color: var(--text-primary);
        }

        /* Modal Animations */
        @keyframes modalEnter {
            from {
                transform: scale(0.8) translateY(40px);
                opacity: 0;
            }
            to {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }

        @keyframes modalExit {
            from {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
            to {
                transform: scale(0.8) translateY(40px);
                opacity: 0;
            }
        }

        /* Notification Modal */
        .notification-modal {
            width: 320px;
            position: fixed;
            top: 20px;
            right: 20px;
            transform: translateX(100%);
            animation: slideInRight 0.5s var(--spring) forwards;
            z-index: 9999;
        }

        .notification-modal.hiding {
            animation: slideOutRight 0.5s var(--spring) forwards;
        }

        /* ===== PROFILE EDIT MODAL STYLES ===== */

        .profile-edit-container {
            display: flex;
            gap: var(--spacing-xl);
            align-items: flex-start;
        }

        .avatar-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-md);
            min-width: 140px;
        }

        .avatar-upload-area {
            position: relative;
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .avatar-upload-area:hover {
            transform: scale(1.05);
        }

        .current-avatar {
            width: 120px;
            height: 120px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            border: 4px solid var(--glass-border);
        }

        .current-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .avatar-placeholder {
            font-size: 48px;
            font-weight: 600;
            color: white;
        }

        .avatar-overlay {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: all var(--transition-normal);
            border-radius: var(--radius-full);
            color: white;
            font-size: 14px;
            font-weight: 500;
            gap: var(--spacing-xs);
        }

        .avatar-upload-area:hover .avatar-overlay {
            opacity: 1;
        }

        .avatar-overlay svg {
            width: 24px;
            height: 24px;
        }

        .remove-avatar-btn {
            background: transparent;
            border: 1px solid var(--accent-error);
            color: var(--accent-error);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-lg);
            font-size: 14px;
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .remove-avatar-btn:hover {
            background: var(--accent-error);
            color: white;
            transform: translateY(-2px);
        }

        .profile-form {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
        }

        .form-group label {
            font-weight: 500;
            color: var(--text-primary);
            font-size: 14px;
        }

        .form-input,
        .form-textarea,
        .form-select {
            padding: var(--spacing-md);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            background: var(--glass-subtle);
            backdrop-filter: blur(var(--glass-blur));
            color: var(--text-primary);
            font-size: 16px;
            transition: all var(--transition-normal);
        }

        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(var(--accent-primary-rgb), 0.1);
            background: var(--glass-bg);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
            font-family: inherit;
        }

        .form-hint {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: var(--spacing-xs);
        }

        .char-counter {
            text-align: right;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .checkbox-group {
            flex-direction: row;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            cursor: pointer;
            font-size: 16px;
            color: var(--text-primary);
        }

        .form-checkbox {
            display: none;
        }

        .checkbox-custom {
            width: 20px;
            height: 20px;
            border: 2px solid var(--glass-border);
            border-radius: var(--radius-sm);
            background: var(--glass-subtle);
            position: relative;
            transition: all var(--transition-normal);
        }

        .form-checkbox:checked + .checkbox-custom {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
        }

        .form-checkbox:checked + .checkbox-custom::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 14px;
            font-weight: bold;
        }

        /* ===== USER SEARCH MODAL STYLES ===== */

        .user-search-modal {
            width: 500px;
            max-height: 600px;
        }

        .search-container {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
        }

        .search-input-group {
            position: relative;
        }

        .search-icon {
            position: absolute;
            left: var(--spacing-md);
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            color: var(--text-secondary);
        }

        .search-input {
            width: 100%;
            padding: var(--spacing-md) var(--spacing-md) var(--spacing-md) 48px;
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            background: var(--glass-subtle);
            backdrop-filter: blur(var(--glass-blur));
            color: var(--text-primary);
            font-size: 16px;
            transition: all var(--transition-normal);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(var(--accent-primary-rgb), 0.1);
            background: var(--glass-bg);
        }

        .search-results {
            max-height: 400px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .search-results::-webkit-scrollbar {
            width: 6px;
        }

        .search-results::-webkit-scrollbar-track {
            background: transparent;
        }

        .search-results::-webkit-scrollbar-thumb {
            background: var(--glass-subtle);
            border-radius: 3px;
        }

        .search-placeholder {
            text-align: center;
            padding: var(--spacing-xl);
            color: var(--text-secondary);
        }

        .search-placeholder-icon {
            font-size: 48px;
            margin-bottom: var(--spacing-md);
        }

        .search-placeholder-text {
            font-size: 16px;
        }

        .user-result {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            border-radius: var(--radius-lg);
            background: var(--glass-subtle);
            backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .user-result:hover {
            background: var(--glass-bg);
            transform: translateY(-2px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .user-result-avatar {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 18px;
        }

        .user-result-info {
            flex: 1;
            min-width: 0;
        }

        .user-result-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .user-result-details {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .user-result-status {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            font-size: 12px;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: var(--radius-full);
            background: var(--accent-success);
        }

        .status-indicator.away {
            background: var(--accent-warning);
        }

        .status-indicator.busy {
            background: var(--accent-error);
        }

        .status-indicator.offline {
            background: var(--text-tertiary);
        }

        /* Draggable Modal Functionality */
        .floating-modal.draggable {
            position: fixed;
        }

        .modal-header.dragging {
            cursor: grabbing;
        }

        /* Theme Toggle */
        .theme-toggle {
            position: relative;
            overflow: hidden;
        }

        .theme-toggle::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            opacity: 0;
            transition: all var(--transition-normal);
            border-radius: var(--radius-lg);
        }

        .theme-toggle:hover::before {
            opacity: 1;
        }

        .theme-toggle svg {
            position: relative;
            z-index: 1;
        }

        /* ===== MESSAGES AREA ===== */

        .messages-container {
            flex: 1;
            padding: var(--spacing-xl);
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: var(--spacing-lg);
            scroll-behavior: smooth;
            position: relative;
        }

        .messages-container::-webkit-scrollbar {
            width: 8px;
        }

        .messages-container::-webkit-scrollbar-track {
            background: transparent;
        }

        .messages-container::-webkit-scrollbar-thumb {
            background: var(--glass-subtle);
            border-radius: 4px;
            backdrop-filter: blur(10px);
        }

        .messages-container::-webkit-scrollbar-thumb:hover {
            background: var(--glass-bg);
        }

        /* Message Group */
        .message-group {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-xs);
            animation: fadeInUp 0.6s var(--spring);
        }

        .message-group.sent {
            align-items: flex-end;
        }

        .message-group.received {
            align-items: flex-start;
        }

        /* Message Bubble */
        .message-bubble {
            max-width: 70%;
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-md) var(--spacing-lg);
            position: relative;
            transition: all var(--transition-normal);
            box-shadow: var(--glass-shadow);
            cursor: pointer;
        }

        .message-bubble:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px var(--shadow-color);
        }

        .message-group.sent .message-bubble {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            border: none;
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-xs);
            opacity: 0.8;
        }

        .message-avatar {
            width: 20px;
            height: 20px;
            border-radius: var(--radius-full);
            background: linear-gradient(135deg, var(--accent-tertiary), var(--accent-quaternary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 10px;
        }

        .message-sender {
            font-weight: 600;
            font-size: 14px;
        }

        .message-time {
            font-size: 12px;
            opacity: 0.7;
            margin-left: auto;
        }

        .message-content {
            font-size: 16px;
            line-height: 1.5;
            word-wrap: break-word;
        }

        .message-group.sent .message-content {
            color: white;
        }

        /* Message States */
        .message-states {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            margin-top: var(--spacing-xs);
            opacity: 0.7;
            font-size: 12px;
        }

        .message-group.sent .message-states {
            color: rgba(255, 255, 255, 0.8);
        }

        .message-check {
            width: 12px;
            height: 12px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        /* Reactions */
        .message-reactions {
            display: flex;
            gap: var(--spacing-xs);
            margin-top: var(--spacing-sm);
            flex-wrap: wrap;
        }

        .reaction {
            background: var(--glass-subtle);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-full);
            padding: 4px 8px;
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .reaction:hover {
            transform: scale(1.1);
            background: var(--accent-primary);
            color: white;
            border-color: var(--accent-primary);
        }

        .reaction-emoji {
            font-size: 14px;
        }

        .reaction-count {
            font-weight: 600;
        }

        /* ===== MESSAGE INPUT AREA ===== */

        .message-input-area {
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            border-top: 1px solid var(--glass-border);
            padding: var(--spacing-lg) var(--spacing-xl);
            position: relative;
            z-index: 70;
            box-shadow: var(--glass-shadow);
        }

        .input-container {
            background: var(--glass-subtle);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-2xl);
            padding: var(--spacing-md);
            display: flex;
            align-items: flex-end;
            gap: var(--spacing-md);
            transition: all var(--transition-normal);
            backdrop-filter: blur(var(--glass-blur));
            position: relative;
        }

        .input-container:focus-within {
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px var(--neon-glow);
            transform: scale(1.01);
        }

        .input-actions-left {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .input-action-btn {
            width: 36px;
            height: 36px;
            background: none;
            border: none;
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-normal);
            color: var(--text-secondary);
        }

        .input-action-btn:hover {
            background: var(--accent-primary);
            color: white;
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 4px 20px var(--neon-glow);
        }

        .input-action-btn svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        .message-input {
            flex: 1;
            background: none;
            border: none;
            outline: none;
            color: var(--text-primary);
            font-size: 16px;
            font-family: inherit;
            line-height: 1.5;
            resize: none;
            min-height: 40px;
            max-height: 120px;
            padding: var(--spacing-sm) 0;
        }

        .message-input::placeholder {
            color: var(--text-tertiary);
        }

        .send-button {
            width: 44px;
            height: 44px;
            background: var(--accent-primary);
            border: none;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-normal);
            color: white;
            flex-shrink: 0;
            box-shadow: 0 4px 20px var(--neon-glow);
        }

        .send-button:hover {
            transform: scale(1.1) rotate(15deg);
            box-shadow: 0 8px 32px var(--neon-glow);
        }

        .send-button:active {
            transform: scale(0.95);
        }

        .send-button svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        /* ===== ANIMATIONS ===== */

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.7;
                transform: scale(1.05);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes ripple {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            100% {
                transform: scale(4);
                opacity: 0;
            }
        }

        /* ===== ENHANCED RESPONSIVE DESIGN SYSTEM ===== */

        /* Enhanced Breakpoints with Perfect Mathematical Progression */
        :root {
            --breakpoint-2xs: 360px;  /* Small phones */
            --breakpoint-xs: 480px;   /* Large phones */
            --breakpoint-sm: 640px;   /* Small tablets */
            --breakpoint-md: 768px;   /* Tablets */
            --breakpoint-lg: 1024px;  /* Small laptops */
            --breakpoint-xl: 1280px;  /* Laptops */
            --breakpoint-2xl: 1536px; /* Large screens */
            --breakpoint-3xl: 1920px; /* Ultra-wide */
        }

        /* Container Query Support for Adaptive Components */
        @supports (container-type: inline-size) {
            .chat-container {
                container-type: inline-size;
            }

            .message-container {
                container-type: inline-size;
            }

            .sidebar-container {
                container-type: inline-size;
            }
        }

        /* Ultra-wide screens (1920px+) - Premium experience */
        @media (min-width: 1920px) {
            :root {
                --sidebar-width: 320px;
                --chat-list-width: 380px;
            }

            .app-container {
                max-width: 2400px;
                margin: 0 auto;
                padding: 0 var(--spacing-2xl);
            }

            .message-bubble {
                max-width: 65%;
                font-size: var(--text-lg);
            }
        }

        /* Large screens (1536px+) - Desktop optimal */
        @media (min-width: 1536px) and (max-width: 1919px) {
            :root {
                --sidebar-width: 300px;
                --chat-list-width: 360px;
            }

            .message-bubble {
                max-width: 70%;
            }
        }

        /* Laptops (1280px+) - Standard desktop */
        @media (min-width: 1280px) and (max-width: 1535px) {
            :root {
                --sidebar-width: 280px;
                --chat-list-width: 340px;
            }
        }

        /* Small laptops (1024px+) - Compact desktop */
        @media (min-width: 1024px) and (max-width: 1279px) {
            :root {
                --sidebar-width: 260px;
                --chat-list-width: 320px;
            }

            .message-bubble {
                font-size: var(--text-sm);
            }
        }

        /* Tablets portrait (768px+) - Sidebar transitions */
        @media (min-width: 768px) and (max-width: 1023px) {
            .sidebar {
                width: var(--sidebar-collapsed);
                transition: width var(--transition-slow) var(--spring);
            }

            .sidebar .user-info,
            .sidebar .nav-text,
            .sidebar .nav-badge {
                opacity: 0;
                transform: translateX(-20px);
                transition: all var(--transition-normal) var(--spring);
            }

            .chat-list-panel {
                width: 300px;
                box-shadow: var(--glass-shadow);
            }

            .message-bubble {
                max-width: 80%;
                font-size: var(--text-sm);
            }
        }

        /* Small tablets (640px+) - Overlay mode */
        @media (min-width: 640px) and (max-width: 767px) {
            .chat-list-panel {
                position: absolute;
                top: 0;
                left: var(--sidebar-collapsed);
                bottom: 0;
                width: 280px;
                z-index: 95;
                transform: translateX(-100%);
                transition: transform var(--transition-normal) var(--spring);
                backdrop-filter: blur(20px);
                box-shadow: var(--glass-shadow-strong);
            }

            .chat-list-panel.open {
                transform: translateX(0);
            }

            .sidebar {
                width: var(--sidebar-collapsed);
            }

            .message-bubble {
                max-width: 85%;
                padding: var(--spacing-md) var(--spacing-lg);
            }
        }

        /* Large phones (480px+) - Mobile optimized */
        @media (min-width: 480px) and (max-width: 639px) {
            .sidebar {
                width: 64px;
                padding: var(--spacing-sm);
            }

            .chat-header {
                padding: var(--spacing-md) var(--spacing-lg);
                height: 64px;
            }

            .messages-container {
                padding: var(--spacing-md);
            }

            .message-input-area {
                padding: var(--spacing-md) var(--spacing-lg);
            }

            .message-bubble {
                max-width: 88%;
                font-size: var(--text-sm);
                padding: var(--spacing-sm) var(--spacing-md);
            }

            .chat-list-panel {
                width: 260px;
            }
        }

        /* Small phones (360px+) - Minimal interface */
        @media (max-width: 479px) {
            .sidebar {
                width: 56px;
                padding: var(--spacing-xs);
            }

            .chat-header {
                padding: var(--spacing-sm) var(--spacing-md);
                height: 56px;
            }

            .messages-container {
                padding: var(--spacing-sm);
            }

            .message-input-area {
                padding: var(--spacing-sm) var(--spacing-md);
            }

            .message-bubble {
                max-width: 92%;
                font-size: var(--text-xs);
                padding: var(--spacing-xs) var(--spacing-sm);
                border-radius: var(--radius-md);
            }

            .chat-list-panel {
                width: 240px;
                left: 56px;
            }

            .user-avatar {
                width: 32px;
                height: 32px;
            }

            .floating-button {
                width: 48px;
                height: 48px;
                bottom: var(--spacing-lg);
                right: var(--spacing-md);
            }
        }

        /* Container Queries for Adaptive Components */
        @container (min-width: 400px) {
            .message-bubble {
                padding: var(--spacing-md) var(--spacing-lg);
            }
        }

        @container (max-width: 300px) {
            .message-bubble {
                padding: var(--spacing-xs) var(--spacing-sm);
                font-size: var(--text-xs);
            }
        }

        /* High DPI displays - Enhanced clarity */
        @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
            .glass-effect {
                backdrop-filter: blur(calc(var(--glass-blur) * 1.2));
            }

            .text-shadow {
                text-shadow: 0 1px 2px rgba(0,0,0,0.1);
            }
        }

        /* Landscape orientation optimizations */
        @media (orientation: landscape) and (max-height: 500px) {
            .chat-header {
                height: 48px;
                padding: var(--spacing-xs) var(--spacing-md);
            }

            .message-input-area {
                padding: var(--spacing-xs) var(--spacing-md);
            }

            .sidebar {
                padding: var(--spacing-xs);
            }
        }

        /* ===== LOADING STATES ===== */

        .loading-skeleton {
            background: linear-gradient(90deg, var(--glass-subtle) 25%, var(--glass-bg) 50%, var(--glass-subtle) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% {
                background-position: 200% 0;
            }
            100% {
                background-position: -200% 0;
            }
        }

        /* ===== UTILITY CLASSES ===== */

        .hidden {
            display: none !important;
        }

        .visually-hidden {
            position: absolute !important;
            width: 1px !important;
            height: 1px !important;
            padding: 0 !important;
            margin: -1px !important;
            overflow: hidden !important;
            clip: rect(0, 0, 0, 0) !important;
            white-space: nowrap !important;
            border: 0 !important;
        }

        .text-gradient {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .glass-effect {
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            border: 1px solid var(--glass-border);
        }

        .neon-glow {
            box-shadow: 0 0 20px var(--neon-glow);
        }

        .animate-bounce {
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% {
                transform: translate3d(0, 0, 0);
            }
            40%, 43% {
                transform: translate3d(0, -8px, 0);
            }
            70% {
                transform: translate3d(0, -4px, 0);
            }
            90% {
                transform: translate3d(0, -2px, 0);
            }
        }

        /* ===== DRAG-AND-DROP ANIMATIONS ===== */

        @keyframes dropBounce {
            0% {
                transform: scale(1.1) rotate(3deg);
                box-shadow: 0 8px 40px var(--neon-glow);
            }
            50% {
                transform: scale(0.95) rotate(-1deg);
                box-shadow: 0 4px 20px var(--neon-glow);
            }
            100% {
                transform: scale(1) rotate(0deg);
                box-shadow: none;
            }
        }

        @keyframes magneticParticle {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 0;
            }
            50% {
                transform: scale(1.2) rotate(180deg);
                opacity: 1;
            }
            100% {
                transform: scale(0) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes magneticPulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 var(--accent-primary);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 0 20px 10px transparent;
            }
        }

        /* Magnetic Zone Styles */
        .nav-item.magnetic-zone {
            position: relative;
            overflow: visible;
        }

        .nav-item.magnetic-zone::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            border: 2px solid transparent;
            border-radius: var(--radius-lg);
            transition: all var(--transition-fast) var(--spring);
            pointer-events: none;
        }

        .nav-item.magnetic-active::before {
            border-color: var(--accent-primary);
            background: radial-gradient(circle, transparent 60%, var(--accent-primary)20);
            animation: magneticPulse 1s infinite ease-in-out;
        }

        .nav-item.dragging {
            cursor: grabbing !important;
            user-select: none;
            position: relative;
            z-index: 1000;
        }

        .nav-item.dragging::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg,
                var(--accent-primary)20,
                var(--accent-secondary)20);
            border-radius: var(--radius-lg);
            pointer-events: none;
            animation: ripple 1s infinite ease-out;
        }

        .nav-item-placeholder {
            display: flex !important;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .nav-item-placeholder::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            background: var(--accent-primary);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: pulse 1.5s infinite ease-in-out;
        }

        /* Enhanced drag feedback */
        .sidebar-nav.drag-active {
            background: var(--glass-subtle);
            backdrop-filter: blur(20px);
            border: 1px solid var(--accent-primary);
            border-radius: var(--radius-lg);
            transition: all var(--transition-normal) var(--spring);
        }

        .sidebar-nav.drag-active .nav-item:not(.dragging) {
            opacity: 0.7;
            transform: scale(0.98);
            transition: all var(--transition-fast) var(--spring);
        }

        .sidebar-nav.drag-active .nav-item:not(.dragging):hover {
            opacity: 1;
            transform: scale(1);
            box-shadow: 0 4px 20px var(--neon-glow);
        }

        /* ===== DIVINE THEME MORPHING ANIMATIONS ===== */

        @keyframes morphParticle {
            0% {
                opacity: 0;
                transform: scale(0) rotate(0deg);
            }
            50% {
                opacity: 1;
                transform: scale(1.2) rotate(180deg);
            }
            100% {
                opacity: 0;
                transform: scale(0) rotate(360deg);
            }
        }

        @keyframes themeWave {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0.8;
            }
            50% {
                opacity: 0.4;
            }
            100% {
                transform: translate(-50%, -50%) scale(20);
                opacity: 0;
            }
        }

        @keyframes themeRipple {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0.6;
            }
            100% {
                transform: translate(-50%, -50%) scale(30);
                opacity: 0;
            }
        }

        /* Theme Morphing States */
        .theme-morphing {
            position: relative;
            overflow: hidden;
        }

        .theme-morphing::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                45deg,
                transparent 30%,
                rgba(255, 255, 255, 0.1) 50%,
                transparent 70%
            );
            transform: translateX(-100%);
            animation: shimmer 0.8s ease-out;
            pointer-events: none;
            z-index: 1;
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(100%);
            }
        }

        /* Light to Dark Morphing */
        .morph-light-to-dark {
            animation: morphToDark 0.8s ease-out;
        }

        @keyframes morphToDark {
            0% {
                filter: brightness(1) hue-rotate(0deg) saturate(1);
            }
            25% {
                filter: brightness(1.2) hue-rotate(10deg) saturate(1.1);
            }
            50% {
                filter: brightness(0.8) hue-rotate(180deg) saturate(0.9);
            }
            75% {
                filter: brightness(0.6) hue-rotate(270deg) saturate(1.2);
            }
            100% {
                filter: brightness(1) hue-rotate(360deg) saturate(1);
            }
        }

        /* Dark to Light Morphing */
        .morph-dark-to-light {
            animation: morphToLight 0.8s ease-out;
        }

        @keyframes morphToLight {
            0% {
                filter: brightness(1) hue-rotate(0deg) saturate(1);
            }
            25% {
                filter: brightness(0.8) hue-rotate(-10deg) saturate(1.1);
            }
            50% {
                filter: brightness(1.3) hue-rotate(-180deg) saturate(0.9);
            }
            75% {
                filter: brightness(1.5) hue-rotate(-270deg) saturate(1.2);
            }
            100% {
                filter: brightness(1) hue-rotate(-360deg) saturate(1);
            }
        }

        /* Enhanced Theme Transition Effects */
        .theme-morph-overlay {
            background: radial-gradient(
                circle at center,
                var(--accent-primary) 0%,
                var(--accent-secondary) 30%,
                transparent 70%
            );
            opacity: 0.1;
            mix-blend-mode: soft-light;
        }

        /* Floating Orb Morph Effects */
        .floating-orb.theme-morphing {
            animation: orbMorph 1s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        @keyframes orbMorph {
            0% {
                transform: scale(1) rotate(0deg);
                filter: hue-rotate(0deg);
            }
            50% {
                transform: scale(1.5) rotate(180deg);
                filter: hue-rotate(180deg);
            }
            100% {
                transform: scale(1) rotate(360deg);
                filter: hue-rotate(360deg);
            }
        }

        /* Modal Morph Effects */
        .floating-modal.theme-morphing {
            animation: modalMorph 0.8s ease-out;
        }

        @keyframes modalMorph {
            0% {
                transform: translate(-50%, -50%) scale(1) rotateY(0deg);
                opacity: 1;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.05) rotateY(10deg);
                opacity: 0.9;
            }
            100% {
                transform: translate(-50%, -50%) scale(1) rotateY(0deg);
                opacity: 1;
            }
        }

        /* Sidebar Morph Effects */
        .sidebar.theme-morphing {
            animation: sidebarMorph 0.8s ease-out;
        }

        @keyframes sidebarMorph {
            0% {
                transform: translateX(0);
                filter: blur(0px);
            }
            50% {
                transform: translateX(5px);
                filter: blur(1px);
            }
            100% {
                transform: translateX(0);
                filter: blur(0px);
            }
        }

        /* Chat Area Morph Effects */
        .chat-area.theme-morphing {
            animation: chatAreaMorph 0.8s ease-out;
        }

        @keyframes chatAreaMorph {
            0% {
                transform: scale(1);
                filter: contrast(1);
            }
            50% {
                transform: scale(1.01);
                filter: contrast(1.1);
            }
            100% {
                transform: scale(1);
                filter: contrast(1);
            }
        }

        /* Navigation Item Morph Effects */
        .nav-item.theme-morphing {
            animation: navItemMorph 0.6s ease-out;
        }

        @keyframes navItemMorph {
            0% {
                transform: translateX(0) scale(1);
            }
            50% {
                transform: translateX(3px) scale(1.02);
            }
            100% {
                transform: translateX(0) scale(1);
            }
        }

        /* Chat Item Morph Effects */
        .chat-item.theme-morphing {
            animation: chatItemMorph 0.6s ease-out;
        }

        @keyframes chatItemMorph {
            0% {
                transform: translateY(0) scale(1);
            }
            50% {
                transform: translateY(-2px) scale(1.01);
            }
            100% {
                transform: translateY(0) scale(1);
            }
        }

        /* Universal Theme Transition */
        * {
            transition: color 0.5s ease, background-color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease;
        }

        /* Prevent transition on theme elements during morph */
        .theme-morphing * {
            transition: none !important;
        }

        /* ===== SECURITY ALERT STYLES ===== */

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .security-alert {
            font-family: var(--font-primary);
            border-left: 4px solid #dc2626;
            backdrop-filter: blur(10px);
        }

        .security-alert:hover {
            transform: translateX(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        /* ===== DIVINE POLISH ANIMATIONS ===== */

        @keyframes microParticle {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 1;
            }
            50% {
                transform: scale(1.5) rotate(180deg);
                opacity: 0.8;
            }
            100% {
                transform: scale(0) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes rainbow {
            0% { filter: hue-rotate(0deg); }
            25% { filter: hue-rotate(90deg); }
            50% { filter: hue-rotate(180deg); }
            75% { filter: hue-rotate(270deg); }
            100% { filter: hue-rotate(360deg); }
        }

        @keyframes divineGlow {
            0%, 100% {
                box-shadow: 0 0 20px var(--accent-primary);
            }
            50% {
                box-shadow: 0 0 40px var(--accent-secondary);
            }
        }

        /* Performance optimizations */
        .optimized-element {
            contain: layout style paint;
            will-change: transform, opacity;
        }

        /* Intersection observer animations */
        .fade-in-element {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .fade-in-element.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Enhanced focus indicators */
        .enhanced-focus:focus {
            outline: 2px solid var(--accent-primary);
            outline-offset: 2px;
            box-shadow: 0 0 0 4px rgba(var(--accent-primary-rgb), 0.2);
        }

        /* Accessibility improvements */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: var(--accent-primary);
            color: white;
            padding: 8px;
            text-decoration: none;
            border-radius: 4px;
            z-index: 10000;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 6px;
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            .nav-item, .chat-item, .floating-modal {
                border: 2px solid;
            }
        }

        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Divine perfection states */
        .divine-perfect {
            animation: divineGlow 2s infinite ease-in-out;
        }

        .divine-shimmer {
            position: relative;
            overflow: hidden;
        }

        .divine-shimmer::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.2),
                transparent
            );
            animation: shimmer 2s infinite;
        }

        /* ===== MOBILE BOTTOM NAVIGATION ===== */

        .mobile-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--glass-bg);
            backdrop-filter: blur(var(--glass-blur));
            border-top: 1px solid var(--glass-border);
            padding: var(--spacing-md);
            z-index: 100;
        }

        .mobile-nav-items {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .mobile-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-xs);
            padding: var(--spacing-sm);
            border-radius: var(--radius-lg);
            cursor: pointer;
            transition: all var(--transition-normal);
            color: var(--text-secondary);
            text-decoration: none;
        }

        .mobile-nav-item:hover,
        .mobile-nav-item.active {
            color: var(--accent-primary);
            transform: translateY(-2px);
        }

        .mobile-nav-item svg {
            width: 24px;
            height: 24px;
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }

        .mobile-nav-item span {
            font-size: 12px;
            font-weight: 500;
        }

        @media (max-width: 640px) {
            .mobile-nav {
                display: block;
            }

            .app-container {
                padding-bottom: 80px;
            }
        }
    </style>
</head>
<body data-theme="light">
    <!-- Floating Background Elements -->
    <div class="bg-elements">
        <div class="floating-orb"></div>
        <div class="floating-orb"></div>
        <div class="floating-orb"></div>
    </div>

    <!-- Mobile Navigation Bar -->
    <div class="mobile-nav-bar">
        <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Open menu"></button>
        <div class="mobile-nav-title">Talk pAI</div>
        <button class="mobile-back-btn" id="mobileBackBtn" aria-label="Back"></button>
    </div>

    <!-- Main App Container -->
    <div class="app-container">
        <!-- Professional Sidebar -->
        <aside class="sidebar" id="sidebar">
            <!-- Sidebar Header -->
            <div class="sidebar-header">
                <div class="user-profile" id="userProfile">
                    <div class="user-avatar">DU</div>
                    <div class="user-info">
                        <div class="user-name">Demo User</div>
                        <div class="user-status">
                            <div class="status-indicator"></div>
                            <span>Online</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar Navigation -->
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-nav="chats">
                    <div class="nav-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                        </svg>
                    </div>
                    <span class="nav-text">Chats</span>
                    <div class="nav-badge">3</div>
                </a>

                <a href="#" class="nav-item" data-nav="groups">
                    <div class="nav-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/>
                            <circle cx="9" cy="7" r="4"/>
                            <path d="M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/>
                        </svg>
                    </div>
                    <span class="nav-text">Groups</span>
                    <div class="nav-badge">7</div>
                </a>

                <a href="#" class="nav-item" data-nav="contacts">
                    <div class="nav-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/>
                            <circle cx="12" cy="7" r="4"/>
                        </svg>
                    </div>
                    <span class="nav-text">Contacts</span>
                </a>

                <a href="#" class="nav-item" data-nav="files">
                    <div class="nav-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M13 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V9z"/>
                            <polyline points="13,2 13,9 20,9"/>
                        </svg>
                    </div>
                    <span class="nav-text">Files</span>
                </a>

                <a href="#" class="nav-item" data-nav="profile" id="profileBtn">
                    <div class="nav-icon">
                        <svg viewBox="0 0 24 24">
                            <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/>
                            <circle cx="12" cy="7" r="4"/>
                        </svg>
                    </div>
                    <span class="nav-text">Profile</span>
                </a>

                <a href="#" class="nav-item" data-nav="search" id="findUsersBtn">
                    <div class="nav-icon">
                        <svg viewBox="0 0 24 24">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="m21 21-4.35-4.35"/>
                        </svg>
                    </div>
                    <span class="nav-text">Find Users</span>
                </a>

                <a href="#" class="nav-item" data-nav="settings">
                    <div class="nav-icon">
                        <svg viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="3"/>
                            <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
                        </svg>
                    </div>
                    <span class="nav-text">Settings</span>
                </a>
            </nav>

            <!-- Sidebar Footer -->
            <div class="sidebar-footer">
                <button class="sidebar-toggle" id="sidebarToggle">
                    <svg viewBox="0 0 24 24">
                        <polyline points="9,18 15,12 9,6"/>
                    </svg>
                </button>
            </div>
        </aside>

        <!-- Chat List Panel -->
        <section class="chat-list-panel" id="chatListPanel">
            <!-- Chat List Header -->
            <div class="chat-list-header">
                <div class="chat-list-title">
                    <h2>Chats</h2>
                    <button class="new-chat-btn" id="newChatBtn">
                        <svg viewBox="0 0 24 24">
                            <line x1="12" y1="5" x2="12" y2="19"/>
                            <line x1="5" y1="12" x2="19" y2="12"/>
                        </svg>
                    </button>
                </div>

                <!-- Global Search -->
                <div class="global-search">
                    <input type="text" class="search-input" id="globalSearch" placeholder="Search conversations...">
                    <div class="search-icon">
                        <svg viewBox="0 0 24 24">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="m21 21-4.35-4.35"/>
                        </svg>
                    </div>
                </div>
            </div>

            <!-- Chat List -->
            <div class="chat-list" id="chatList">
                <!-- Demo Chat Items -->
                <a href="#" class="chat-item active" data-chat="1">
                    <div class="chat-avatar">AI</div>
                    <div class="chat-info">
                        <div class="chat-name">AI Assistant</div>
                        <div class="chat-preview">How can I help you today?</div>
                    </div>
                    <div class="chat-meta">
                        <div class="chat-time">2:30 PM</div>
                        <div class="chat-unread">2</div>
                    </div>
                </a>

                <a href="#" class="chat-item" data-chat="2">
                    <div class="chat-avatar">GE</div>
                    <div class="chat-info">
                        <div class="chat-name">General</div>
                        <div class="chat-preview">Welcome to Talk pAI!</div>
                    </div>
                    <div class="chat-meta">
                        <div class="chat-time">1:45 PM</div>
                    </div>
                </a>

                <a href="#" class="chat-item" data-chat="3">
                    <div class="chat-avatar">TC</div>
                    <div class="chat-info">
                        <div class="chat-name">Team Chat</div>
                        <div class="chat-preview">Great work everyone!</div>
                    </div>
                    <div class="chat-meta">
                        <div class="chat-time">12:15 PM</div>
                        <div class="chat-unread">5</div>
                    </div>
                </a>
            </div>
        </section>

        <!-- Main Chat Area -->
        <main class="main-chat">
            <!-- Chat Header -->
            <header class="chat-header">
                <div class="chat-header-info">
                    <div class="chat-header-avatar">AI</div>
                    <div class="chat-header-details">
                        <div class="chat-header-name">AI Assistant</div>
                        <div class="chat-header-status">
                            <div class="typing-indicator">
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                                <span>AI is typing...</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chat-header-actions">
                    <button class="header-action-btn" id="searchBtn">
                        <svg viewBox="0 0 24 24">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="m21 21-4.35-4.35"/>
                        </svg>
                    </button>

                    <button class="header-action-btn" id="callBtn">
                        <svg viewBox="0 0 24 24">
                            <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"/>
                        </svg>
                    </button>

                    <button class="header-action-btn" id="videoBtn">
                        <svg viewBox="0 0 24 24">
                            <polygon points="23 7 16 12 23 17 23 7"/>
                            <rect x="1" y="5" width="15" height="14" rx="2" ry="2"/>
                        </svg>
                    </button>

                    <button class="header-action-btn theme-toggle" id="themeToggle">
                        <svg viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="5"/>
                            <line x1="12" y1="1" x2="12" y2="3"/>
                            <line x1="12" y1="21" x2="12" y2="23"/>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                            <line x1="1" y1="12" x2="3" y2="12"/>
                            <line x1="21" y1="12" x2="23" y2="12"/>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
                        </svg>
                    </button>
                </div>
            </header>

            <!-- Messages Container -->
            <div class="messages-container" id="messagesContainer">
                <!-- Demo Messages -->
                <div class="message-group received">
                    <div class="message-bubble">
                        <div class="message-header">
                            <div class="message-avatar">AI</div>
                            <span class="message-sender">AI Assistant</span>
                            <span class="message-time">2:28 PM</span>
                        </div>
                        <div class="message-content">
                            Welcome to Talk pAI!  This is an award-winning ultra-modern messaging platform with glassmorphism design, smooth animations, and premium micro-interactions. How can I help you today?
                        </div>
                        <div class="message-reactions">
                            <div class="reaction">
                                <span class="reaction-emoji"></span>
                                <span class="reaction-count">2</span>
                            </div>
                            <div class="reaction">
                                <span class="reaction-emoji"></span>
                                <span class="reaction-count">1</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="message-group sent">
                    <div class="message-bubble">
                        <div class="message-content">
                            This looks absolutely incredible! The glassmorphism effects and smooth animations are perfect. 
                        </div>
                        <div class="message-states">
                            <svg class="message-check" viewBox="0 0 24 24">
                                <polyline points="20,6 9,17 4,12"/>
                            </svg>
                            <svg class="message-check" viewBox="0 0 24 24">
                                <polyline points="20,6 9,17 4,12"/>
                            </svg>
                            <span>Read</span>
                        </div>
                    </div>
                </div>

                <div class="message-group received">
                    <div class="message-bubble">
                        <div class="message-header">
                            <div class="message-avatar">AI</div>
                            <span class="message-sender">AI Assistant</span>
                            <span class="message-time">2:30 PM</span>
                        </div>
                        <div class="message-content">
                            Thank you!  I'm designed with the latest design trends: glassmorphism, neumorphism, spring animations, and beautiful micro-interactions. Every element is crafted for an award-winning user experience!
                        </div>
                    </div>
                </div>
            </div>

            <!-- Message Input Area -->
            <div class="message-input-area">
                <div class="input-container">
                    <div class="input-actions-left">
                        <button class="input-action-btn" id="emojiBtn">
                            <svg viewBox="0 0 24 24">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M8 14s1.5 2 4 2 4-2 4-2"/>
                                <line x1="9" y1="9" x2="9.01" y2="9"/>
                                <line x1="15" y1="9" x2="15.01" y2="9"/>
                            </svg>
                        </button>

                        <button class="input-action-btn" id="attachBtn">
                            <svg viewBox="0 0 24 24">
                                <path d="M21.44 11.05l-9.19 9.19a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 015.66 5.66L9.64 16.2a2 2 0 01-2.83-2.83l8.49-8.49"/>
                            </svg>
                        </button>

                        <button class="input-action-btn" id="voiceBtn">
                            <svg viewBox="0 0 24 24">
                                <path d="M12 1a3 3 0 00-3 3v8a3 3 0 006 0V4a3 3 0 00-3-3z"/>
                                <path d="M19 10v2a7 7 0 01-14 0v-2"/>
                                <line x1="12" y1="19" x2="12" y2="23"/>
                                <line x1="8" y1="23" x2="16" y2="23"/>
                            </svg>
                        </button>
                    </div>

                    <textarea class="message-input" id="messageInput" placeholder="Type your message..." rows="1"></textarea>

                    <button class="send-button" id="sendBtn">
                        <svg viewBox="0 0 24 24">
                            <line x1="22" y1="2" x2="11" y2="13"/>
                            <polygon points="22,2 15,22 11,13 2,9 22,2"/>
                        </svg>
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Mobile Bottom Navigation -->
    <nav class="mobile-nav">
        <div class="mobile-nav-items">
            <a href="#" class="mobile-nav-item active">
                <svg viewBox="0 0 24 24">
                    <path d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                </svg>
                <span>Chats</span>
            </a>
            <a href="#" class="mobile-nav-item">
                <svg viewBox="0 0 24 24">
                    <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/>
                    <circle cx="9" cy="7" r="4"/>
                    <path d="M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/>
                </svg>
                <span>Groups</span>
            </a>
            <a href="#" class="mobile-nav-item">
                <svg viewBox="0 0 24 24">
                    <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/>
                    <circle cx="12" cy="7" r="4"/>
                </svg>
                <span>Contacts</span>
            </a>
            <a href="#" class="mobile-nav-item">
                <svg viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
                </svg>
                <span>Settings</span>
            </a>
        </div>
    </nav>

    <!-- Voice & Video Call Interface -->
    <div class="call-overlay" id="callOverlay">
        <div class="call-interface">
            <div class="call-header">
                <div class="call-user-info">
                    <div class="call-avatar" id="callAvatar">AI</div>
                    <div class="call-user-name" id="callUserName">AI Assistant</div>
                    <div class="call-status" id="callStatus">
                        <span>Calling...</span>
                    </div>
                    <div class="call-timer" id="callTimer" style="display: none;">00:00</div>
                </div>
            </div>

            <div class="video-container" id="videoContainer" style="display: none;">
                <video class="main-video" id="remoteVideo" autoplay playsinline></video>
                <div class="local-video" id="localVideoContainer">
                    <video id="localVideo" autoplay muted playsinline></video>
                </div>
                <div class="screen-share-indicator" id="screenShareIndicator">
                    Screen sharing
                </div>
            </div>

            <div class="call-controls" id="callControls">
                <!-- Voice Call Controls -->
                <div class="voice-controls" id="voiceControls">
                    <button class="call-control-btn btn-mute" id="muteBtn">
                        <svg viewBox="0 0 24 24">
                            <path d="m9 9 3 3m0 0 3 3m-3-3 3-3m-3 3-3 3m-1-8a5 5 0 0 1 10 0v8.5"/>
                            <line x1="12" y1="17" x2="12" y2="17"/>
                        </svg>
                    </button>

                    <button class="call-control-btn btn-speaker" id="speakerBtn">
                        <svg viewBox="0 0 24 24">
                            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
                            <path d="m19.07 4.93-1.41 1.41A5 5 0 0 1 20 12a5 5 0 0 1-2.34 4.24l1.41 1.41A7 7 0 0 0 22 12a7 7 0 0 0-2.93-5.07z"/>
                            <path d="m15.54 8.46-1.41 1.41A3 3 0 0 1 16 12a3 3 0 0 1-1.87 2.13l1.41 1.41A5 5 0 0 0 18 12a5 5 0 0 0-2.46-4.54z"/>
                        </svg>
                    </button>

                    <button class="call-control-btn btn-end-call" id="endCallBtn">
                        <svg viewBox="0 0 24 24">
                            <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"/>
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                </div>

                <!-- Video Call Controls -->
                <div class="video-controls" id="videoControls" style="display: none;">
                    <button class="call-control-btn btn-mute" id="videoMuteBtn">
                        <svg viewBox="0 0 24 24">
                            <path d="m9 9 3 3m0 0 3 3m-3-3 3-3m-3 3-3 3m-1-8a5 5 0 0 1 10 0v8.5"/>
                            <line x1="12" y1="17" x2="12" y2="17"/>
                        </svg>
                    </button>

                    <button class="call-control-btn btn-camera" id="cameraBtn">
                        <svg viewBox="0 0 24 24">
                            <polygon points="23 7 16 12 23 17 23 7"/>
                            <rect x="1" y="5" width="15" height="14" rx="2" ry="2"/>
                        </svg>
                    </button>

                    <button class="call-control-btn btn-screen-share" id="screenShareBtn">
                        <svg viewBox="0 0 24 24">
                            <rect x="2" y="4" width="20" height="12" rx="2"/>
                            <polyline points="8,21 16,21"/>
                            <line x1="12" y1="17" x2="12" y2="21"/>
                        </svg>
                    </button>

                    <button class="call-control-btn btn-more" id="moreBtn">
                        <svg viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="1"/>
                            <circle cx="12" cy="5" r="1"/>
                            <circle cx="12" cy="19" r="1"/>
                        </svg>
                    </button>

                    <button class="call-control-btn btn-end-call" id="videoEndCallBtn">
                        <svg viewBox="0 0 24 24">
                            <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"/>
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                </div>

                <!-- Incoming Call Controls -->
                <div class="incoming-controls" id="incomingControls" style="display: none;">
                    <button class="call-control-btn btn-decline" id="declineBtn">
                        <svg viewBox="0 0 24 24">
                            <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"/>
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>

                    <button class="call-control-btn btn-answer" id="answerBtn">
                        <svg viewBox="0 0 24 24">
                            <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Call Notification -->
    <div class="call-notification" id="callNotification">
        <div class="call-notification-header">
            <div class="call-notification-avatar" id="notificationAvatar">AI</div>
            <div class="call-notification-info">
                <div class="call-notification-name" id="notificationName">AI Assistant</div>
                <div class="call-notification-type" id="notificationType">Incoming voice call</div>
            </div>
        </div>
        <div class="call-notification-actions">
            <button class="call-notification-btn btn-notification-decline" id="notificationDecline">
                <svg viewBox="0 0 24 24">
                    <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"/>
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
            <button class="call-notification-btn btn-notification-answer" id="notificationAnswer">
                <svg viewBox="0 0 24 24">
                    <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"/>
                </svg>
            </button>
        </div>
    </div>

    <!-- Drag & Drop Zone -->
    <div class="drag-drop-zone" id="dragDropZone">
        <div class="drop-area" id="dropArea">
            <div class="drop-icon">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                </svg>
            </div>
            <div class="drop-text">
                <div class="drop-title">Drop files here</div>
                <div class="drop-subtitle">Drag and drop files to upload them instantly</div>
            </div>
        </div>
    </div>

    <!-- File Preview Modal -->
    <div class="file-preview" id="filePreview">
        <div class="file-preview-header">
            <div class="file-preview-title">File Upload</div>
            <button class="file-preview-close" id="filePreviewClose">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
        </div>
        <div class="file-list" id="fileList">
            <!-- Files will be dynamically added here -->
        </div>
        <div class="file-actions">
            <button class="file-action-btn btn-cancel" id="fileCancelBtn">Cancel</button>
            <button class="file-action-btn btn-send" id="fileSendBtn">Send Files</button>
        </div>
    </div>

    <!-- Profile Edit Modal -->
    <div class="modal-overlay" id="profileModalOverlay">
        <div class="floating-modal profile-modal" id="profileModal">
            <div class="modal-header" id="profileModalHeader">
                <div class="modal-title">
                    <div class="modal-icon"></div>
                    Edit Profile
                </div>
                <div class="modal-controls">
                    <button class="modal-control-btn minimize" id="profileMinimizeBtn">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="6" y1="12" x2="18" y2="12"/>
                        </svg>
                    </button>
                    <button class="modal-control-btn maximize" id="profileMaximizeBtn">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2"/>
                        </svg>
                    </button>
                    <button class="modal-control-btn close" id="profileCloseBtn">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="modal-body">
                <div class="profile-edit-container">
                    <!-- Avatar Section -->
                    <div class="avatar-section">
                        <div class="avatar-upload-area" id="avatarUploadArea">
                            <div class="current-avatar" id="currentAvatar">
                                <img id="avatarImage" src="" alt="Avatar" style="display: none;">
                                <div class="avatar-placeholder" id="avatarPlaceholder">AI</div>
                            </div>
                            <div class="avatar-overlay">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
                                    <circle cx="12" cy="13" r="4"/>
                                </svg>
                                <span>Change Avatar</span>
                            </div>
                        </div>
                        <button class="remove-avatar-btn" id="removeAvatarBtn">Remove Avatar</button>
                    </div>

                    <!-- Profile Form -->
                    <div class="profile-form">
                        <div class="form-group">
                            <label for="profileDisplayName">Display Name</label>
                            <input type="text" id="profileDisplayName" class="form-input" placeholder="Enter display name">
                        </div>

                        <div class="form-group">
                            <label for="profileNickname">Nickname</label>
                            <input type="text" id="profileNickname" class="form-input" placeholder="Enter nickname" readonly>
                            <small class="form-hint">Nickname cannot be changed</small>
                        </div>

                        <div class="form-group">
                            <label for="profileEmail">Email</label>
                            <input type="email" id="profileEmail" class="form-input" placeholder="Enter email">
                        </div>

                        <div class="form-group">
                            <label for="profileBio">Bio</label>
                            <textarea id="profileBio" class="form-textarea" placeholder="Tell us about yourself..." rows="3"></textarea>
                            <div class="char-counter">
                                <span id="bioCharCount">0</span>/500
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="profileStatus">Status</label>
                            <select id="profileStatus" class="form-select">
                                <option value="online"> Online</option>
                                <option value="away"> Away</option>
                                <option value="busy"> Busy</option>
                                <option value="invisible"> Invisible</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="profileTheme">Theme Preference</label>
                            <select id="profileTheme" class="form-select">
                                <option value="light"> Light</option>
                                <option value="dark"> Dark</option>
                                <option value="auto"> Auto</option>
                            </select>
                        </div>

                        <div class="form-group checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="notificationsEnabled" class="form-checkbox">
                                <span class="checkbox-custom"></span>
                                Enable notifications
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-secondary" id="profileCancelBtn">Cancel</button>
                <button class="modal-btn modal-btn-primary" id="profileSaveBtn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 16px; height: 16px;">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                        <polyline points="17,21 17,13 7,13 7,21"/>
                        <polyline points="7,3 7,8 15,8"/>
                    </svg>
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- User Search Modal -->
    <div class="modal-overlay" id="userSearchModalOverlay">
        <div class="floating-modal user-search-modal" id="userSearchModal">
            <div class="modal-header" id="userSearchModalHeader">
                <div class="modal-title">
                    <div class="modal-icon"></div>
                    Find Users
                </div>
                <div class="modal-controls">
                    <button class="modal-control-btn close" id="userSearchCloseBtn">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="modal-body">
                <div class="search-container">
                    <div class="search-input-group">
                        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="m21 21-4.35-4.35"/>
                        </svg>
                        <input type="text" id="userSearchInput" class="search-input" placeholder="Search by nickname, name, or email...">
                    </div>
                    <div class="search-results" id="searchResults">
                        <div class="search-placeholder">
                            <div class="search-placeholder-icon"></div>
                            <div class="search-placeholder-text">Start typing to search for users</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Load External Scripts -->
    <script src="theme-customizer.js"></script>
    <script src="emoji-picker.js"></script>

    <!-- Enhanced Modular JavaScript Architecture -->
    <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
    <script src="js/utils/error-handler.js"></script>
    <script src="js/core/messenger-core.js"></script>
    <script src="js/modules/ui-events.js"></script>
    <script src="js/modules/call-manager.js"></script>
    <script src="js/modules/webrtc-client.js"></script>
    <script src="js/components.js"></script>
    <script src="js/app.js"></script>

    <script>
        // ===== SIMPLIFIED INITIALIZATION =====
        // All complex logic is handled by the modular app.js architecture

        console.log(' TalkPAI Messenger - Ultra-Modern Edition');
        console.log(' All functionality managed by modular architecture');

        // Simple initialization hook
        window.addEventListener('talkpai:initialized', function(event) {
            console.log(' TalkPAI fully loaded and ready!');
            console.log(' Try typing in the message input and clicking send');
            console.log(' Access demo functions via: demoFunctions.sendDemoMessage()');
        });

        // Debug panel toggle
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.shiftKey && e.key === 'D') {
                e.preventDefault();
                toggleDebugPanel();
            }
        });

        function toggleDebugPanel() {
            console.log(' Debug info:', {
                app: window.app,
                messenger: window.messenger,
                uiEvents: window.uiEvents,
                initialized: window.app ? window.app.isInitialized() : false
            });
        }

        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js')
                .then(registration => console.log(' SW registered'))
                .catch(error => console.log(' SW registration failed:', error));
        }
    </script>
</body>
</html>
